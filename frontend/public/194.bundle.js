"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[194],{20010:function(e,t,n){var r=n(14014),a=n(67294),o=["onChange"];function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}var u=(0,a.forwardRef)((function(e,t){var n=e.onChange,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,o);return React.createElement(r.oc,i({},a,{mask:"00000000-#",definitions:{"#":/[0-9kK]/},inputRef:t,onAccept:function(t){return n({target:{name:e.name,value:t}})},overwrite:!0}))}));t.Z=u},40870:function(e,t){t.Z=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}},52394:function(e,t){t.Z=function(e){if(e){if(e=e.replace(/\./g,""),!/^[0-9]+[-]{1}[0-9kK]{1}$/.test(e))return!1;var t=e.split("-"),n=t[1],r=t[0];"k"===n&&(n="K");for(var a=0,o=1;r;r=Math.floor(r/10))o=(o+r%10*(9-a++%6))%11;return n===(o?(o-1).toString():"K")}return!1}},10194:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(67294),a=n(2658),o=n(15725),i=n(67109),u=n(69041),c=n(94659),l=n(66186),s=n(93155),f=n(72642),m=n(39704),p=n(1902),d=(n(77730),p.Z.initializeApp({apiKey:"AIzaSyDDIMJkHO5dGnTjx-wRikj0_-qu7_hFQt4",authDomain:"escalab-node-react.firebaseapp.com",projectId:"escalab-node-react",storageBucket:"escalab-node-react.appspot.com",messagingSenderId:"135581204752",appId:"1:135581204752:web:6f2563f85053d0365be595"})),g=n(96245),v=n(52394),h=n(40870),y=n(66818),w=n(56861),b=n(89066),S=n(16412),Z=n(20010),E=n(20382);function k(e,t,n,r,a,o,i){try{var u=e[o](i),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,a)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){k(o,r,a,i,u,"next",e)}function u(e){k(o,r,a,i,u,"throw",e)}i(void 0)}))}}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=function(){var e=(0,m.v9)((function(e){return e.auth})),t=(0,m.I0)(),n=I((0,r.useState)(e.firstname),2),p=n[0],k=n[1],C=I((0,r.useState)(e.lastname),2),O=C[0],A=C[1],P=I((0,r.useState)("".concat(e.rut,"-").concat(e.dv)),2),R=P[0],j=P[1],_=I((0,r.useState)(R),2),T=_[0],z=_[1],M=I((0,r.useState)(!1),2),D=M[0],K=M[1],U=I((0,r.useState)(e.email),2),W=U[0],$=U[1],q=I((0,r.useState)(W),2),B=q[0],L=q[1],N=I((0,r.useState)(!1),2),F=N[0],G=N[1],H=I((0,r.useState)(!1),2),J=H[0],Q=H[1],V=I((0,r.useState)(""),2),X=V[0],Y=V[1],ee=I((0,r.useState)(0),2),te=ee[0],ne=ee[1],re=function(){var n=x(regeneratorRuntime.mark((function n(r){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a="/users/".concat(e.uid,"/account"),n.next=3,b.Z.post(a,{foto:r}).then((function(e){var n=e.data.data.access_token,r=(0,g.Z)(n);Math.floor(Date.now()/1e3)<r.exp&&(window.localStorage.setItem("_token",n),t((0,S.z)(n)))})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),ae=I((0,r.useState)(!1),2),oe=ae[0],ie=ae[1];function ue(){return ue=x(regeneratorRuntime.mark((function n(){var r,a,o,i,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=R.split(/-/),a=I(r,2),o=a[0],i=a[1],u={firstname:p,lastname:O,rut:o,dv:i,email:W},t((0,E.dO)(!0)),n.next=5,b.Z.put("/users/".concat(e.uid,"/account"),u).then((function(e){var n=e.data.data;if(1===n.logout)window.localStorage.removeItem("_token"),window.location="/";else{var r=n.access_token;window.localStorage.setItem("_token",r),t((0,S.z)(r))}})).catch((function(e){console.log(e),e.response.data.data.messages?Y(e.response.data.data.messages):Y(e.message),Q(!0),console.log(e)})).finally((function(){t((0,E.dO)(!1))}));case 5:case"end":return n.stop()}}),n)}))),ue.apply(this,arguments)}return(0,r.useEffect)((function(){document.title="Mi Cuenta"}),[]),(0,r.useEffect)((function(){ie(!!(p&&O&&R&&W))}),[p,O,R,W]),r.createElement(r.Fragment,null,r.createElement(a.Z,{variant:"h3",color:"initial"},"Mi Cuenta"),r.createElement(o.ZP,{container:!0,spacing:4,className:"mt-20"},r.createElement(o.ZP,{item:!0,xs:12,md:4,style:{textAlign:"center"}},r.createElement(i.Z,{alt:e.name,src:e.foto,sx:{width:200,height:200,margin:"0 auto"}}),r.createElement("form",null,r.createElement("input",{type:"file",style:{display:"none"},id:"newImage",onChange:function(n){if(ne(0),n.target.files[0]){var r=n.target.files[0],a=/[.]/.exec(r.name)?/[^.]+$/.exec(r.name):"undefined",o="imagenes/foto/".concat(e.uid,".").concat(a),i=d.storage().ref(o).put(r);i.on("state_changed",(function(e){ne(100*Math.round(e.bytesTransferred/e.totalBytes))}),(function(e){console.log(e)}),(function(){t((0,E.dO)(!0)),i.snapshot.ref.getDownloadURL().then(function(){var e=x(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t((0,E.dO)(!1))}))}))}},accept:"image/*"}),r.createElement(w.Z,{onClick:function(){return document.querySelector("#newImage").click()},style:{cursor:"pointer",marginTop:"10px",marginBottom:"10px"}}),r.createElement(u.Z,{variant:"determinate",value:te,color:"error"}))),r.createElement(o.ZP,{item:!0,xs:12,md:8},r.createElement("form",null,r.createElement(c.Z,{error:!p,label:"Nombre",id:"firstname",value:p,onChange:function(e){return k(e.target.value)},fullWidth:!0,margin:"normal"}),r.createElement(c.Z,{error:!O,label:"Apellido",id:"lastname",value:O,onChange:function(e){return A(e.target.value)},fullWidth:!0,margin:"normal"}),r.createElement(c.Z,{error:D,label:"R.U.T.",id:"rut",value:T,onChange:function(e){return t=e.target.value.toUpperCase(),z(t),void((0,v.Z)(t)?(K(!1),j(t)):(j(""),K(!0),z(t)));var t},fullWidth:!0,InputProps:{inputComponent:Z.Z},margin:"normal"}),r.createElement(c.Z,{error:F,label:"Correo EletrÃ³nico",id:"email",value:B,onChange:function(e){return function(e){L(e),(0,h.Z)(e)?(G(!1),$(e)):($(""),G(!0),L(e))}(e.target.value)},fullWidth:!0,margin:"normal"}),J&&r.createElement(l.Z,{severity:"error",style:{textAlign:"left",marginTop:"20px"}},r.createElement(s.Z,null,"Error"),X),r.createElement(f.Z,{onClick:function(){return ue.apply(this,arguments)},startIcon:r.createElement(y.Z,null),variant:"contained",className:"mt-20 ".concat(oe?"buttonPrimary":""),disabled:!oe},"Guardar")))))}},89066:function(e,t,n){var r=n(9669),a=n.n(r)().create({baseURL:process.env.REACT_APP_API_HOST});a.interceptors.request.use((function(e){return window.localStorage.getItem("_token")&&(e.headers.Authorization="bearer "+window.localStorage.getItem("_token")),e}),(function(e){return Promise.reject(e)})),t.Z=a}}]);
//# sourceMappingURL=194.bundle.js.map